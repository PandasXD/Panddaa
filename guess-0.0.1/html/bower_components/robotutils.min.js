RobotUtils=function(n){function t(n,t,e){var o=document.createElement("script"),i=document.getElementsByTagName("script")[0];o.async=1,i.parentNode.insertBefore(o,i),o.onload=o.onreadystatechange=function(n,i){(i||!o.readyState||/loaded|complete/.test(o.readyState))&&(o.onload=o.onreadystatechange=null,o=void 0,i?e&&e():t&&t())},o.src=n}function e(){var n=new RegExp("[\\?&]robot=([^&#]*)"),t=n.exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," ").replace("/",""))}function o(n){var t=n.toString().replace(s,""),e=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g);return null===e&&(e=[]),e}function i(n){this._event=n,this._internalId=null,this._sub=null,this._unsubscribe=!1}n.onServices=function(t,e){n.connect(function(n){var i,s=o(t),r=s.length,c=new Array(s.length);for(i=0;i<s.length;i++)!function(o){n.service(s[o]).then(function(n){c[o]=n,r-=1,0==r&&t.apply(void 0,c)},function(){var n="Failed getting a NaoQi Module: "+s[o];console.log(n),e&&e(n)})}(i)},e)},n.onService=n.onServices,n.subscribeToALMemoryEvent=function(t,e,o){var s=new i(t);return n.onServices(function(ALMemory){ALMemory.subscriber(t).then(function(n){s.setSubscriber(n),n.signal.connect(e).then(function(n){s.setId(n),o&&o(n)})},r)}),s},n.connect=function(e,o){function i(t){n.session=t;for(var e=c.length,o=0;o<e;o++)c[o](t)}if(n.session)return void e(n.session);if(c.length>0)return void c.push(e);c.push(e);var s=null,r="/libs/";n.robotIp&&(r="http://"+n.robotIp+"/libs/",s=n.robotIp+":80"),t(r+"qimessaging/2/qimessaging.js",function(){QiSession(i,o,s)},function(){n.robotIp?console.error("Failed to get qimessaging.js from robot: "+n.robotIp):console.error("Failed to get qimessaging.js from this domain; host this app on a robot or add a ?robot=MY-ROBOT-IP to the URL."),o()})},n.robotIp=e(),n.session=null;var s=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;i.prototype.setId=function(n){this._internalId=n,this._unsubscribe&&this.unsubscribe(this._unsubscribeCallback)},i.prototype.setSubscriber=function(n){this._sub=n,this._unsubscribe&&this.unsubscribe(this._unsubscribeCallback)},i.prototype.unsubscribe=function(n){null!=this._internalId&&null!=this._sub?(evtSubscription=this,evtSubscription._sub.signal.disconnect(evtSubscription._internalId).then(function(){n&&n()}).fail(r)):(this._unsubscribe=!0,this._unsubscribeCallback=n)};var r=function(n){console.log("ALMemory error: "+n)},c=[];return n}(window.RobotUtils||{});